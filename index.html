<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        .card.asked {
            background-color: rgba(0, 0, 0, 0.3);
            color: rgba(255, 255, 255, 0.5);
            cursor: not-allowed;
        }
        .card.asked:hover {
            transform: none;
            box-shadow: none;
        }
        .modal {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
        }
        .reward-modal-content {
             background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
        }
        .btn {
            transition: all 0.2s ease;
        }
        .btn:hover {
            transform: scale(1.05);
        }
        .team-score-card {
            background-color: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .nav-btn-active {
            box-shadow: 0 0 15px rgba(255,255,255,0.7);
            transform: scale(1.05);
        }
    </style>
</head>
<body class="text-white min-h-screen flex flex-col items-center p-4">

    <div class="w-full max-w-7xl mx-auto">
        <!-- Navigation Buttons -->
        <div class="flex flex-wrap justify-center gap-4 mb-6">
            <button id="page1-btn" class="btn bg-blue-600 text-white font-bold py-2 px-6 rounded-full nav-btn-active">1. ‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</button>
            <button id="page2-btn" class="btn bg-gray-500 hover:bg-purple-600 text-white font-bold py-2 px-6 rounded-full">2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô</button>
            <button id="page3-btn" class="btn bg-gray-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full">3. ‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô</button>
            <button id="page4-btn" class="btn bg-gray-500 hover:bg-orange-600 text-white font-bold py-2 px-6 rounded-full">4. ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á</button>
        </div>

        <!-- Game Page 1 -->
        <div id="game-container-1">
            <h1 class="text-4xl md:text-5xl font-bold text-center mb-6 text-shadow">‡πÄ‡∏Å‡∏°‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</h1>
            <div id="scoreboard-1" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"></div>
            <div id="game-board-1" class="grid grid-cols-4 gap-4"></div>
            <div class="mt-8 text-center">
                <button data-reset-type="page1" class="reset-btn btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded-full shadow-lg">
                    ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </div>

        <!-- Game Page 2 (initially hidden) -->
        <div id="game-container-2" class="hidden">
            <h1 class="text-4xl md:text-5xl font-bold text-center mb-6 text-shadow">‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô (Q=mcŒîT, Q=mL)</h1>
            <div id="scoreboard-2" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"></div>
            <div id="game-board-2" class="grid grid-cols-3 gap-4"></div>
            <div class="mt-8 text-center">
                <button data-reset-type="page2" class="reset-btn btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded-full shadow-lg">
                    ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </div>

        <!-- Game Page 3 (initially hidden) -->
        <div id="game-container-3" class="hidden">
            <h1 class="text-4xl md:text-5xl font-bold text-center mb-6 text-shadow">‡πÄ‡∏Å‡∏°‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô</h1>
            <div id="scoreboard-3" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"></div>
            <div id="game-board-3" class="grid grid-cols-4 gap-4"></div>
            <div class="mt-8 text-center">
                <button data-reset-type="page3" class="reset-btn btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded-full shadow-lg">
                    ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </div>

        <!-- Game Page 4 (initially hidden) -->
        <div id="game-container-4" class="hidden">
            <h1 class="text-4xl md:text-5xl font-bold text-center mb-6 text-shadow">‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ß‡∏±‡∏î‡∏î‡∏ß‡∏á (+‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•)</h1>
            <div id="scoreboard-4" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"></div>
            <div id="game-board-4" class="grid grid-cols-5 gap-4"></div>
            <div class="mt-8 text-center">
                <button data-reset-type="page4" class="reset-btn btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded-full shadow-lg">
                    ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ
                </button>
            </div>
        </div>
        
        <hr class="my-8 border-t-2 border-white/30">
        
        <div class="text-center">
             <button data-reset-type="full" class="reset-btn btn bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full shadow-xl text-lg">
                ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="question-modal" class="modal fixed inset-0 w-full h-full flex items-center justify-center hidden">
        <div class="modal-content w-11/12 md:w-2/3 max-w-4xl p-8 rounded-2xl shadow-2xl text-gray-800 flex flex-col items-center text-center">
            <p class="text-lg font-semibold mb-2" id="modal-category"></p>
            <p class="text-4xl font-bold mb-4" id="modal-points"></p>
            <p class="text-2xl md:text-3xl mb-8 min-h-[100px]" id="modal-question"></p>
            <div id="modal-answer-container" class="hidden w-full">
                <p class="text-xl font-bold mb-2">‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠:</p>
                <p class="text-3xl md:text-4xl font-bold text-green-700 mb-8" id="modal-answer"></p>
                <p class="text-lg font-semibold mb-4">‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡∏°:</p>
                <div id="award-buttons" class="flex flex-wrap justify-center gap-4"></div>
            </div>
            <button id="reveal-answer-btn" class="btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-xl shadow-lg">‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-700 hover:text-gray-900 text-3xl font-bold">&times;</button>
        </div>
    </div>

    <!-- Reward Modal -->
    <div id="reward-modal" class="modal fixed inset-0 w-full h-full flex items-center justify-center hidden">
        <div class="reward-modal-content w-11/12 md:w-2/3 max-w-4xl p-8 rounded-2xl shadow-2xl text-gray-800 flex flex-col items-center text-center">
            <h2 class="text-4xl font-bold mb-4 text-orange-800">üéâ ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å! ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏û‡∏¥‡πÄ‡∏®‡∏©! üéâ</h2>
            <p class="text-2xl md:text-3xl font-bold mb-8 min-h-[100px] text-orange-900" id="reward-text"></p>
            <p class="text-lg font-semibold mb-4">‡∏°‡∏≠‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡∏°:</p>
            <div id="reward-buttons" class="flex flex-wrap justify-center gap-4"></div>
            <button id="close-reward-modal-btn" class="absolute top-4 right-4 text-gray-700 hover:text-gray-900 text-3xl font-bold">&times;</button>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div id="reset-modal" class="modal fixed inset-0 w-full h-full flex items-center justify-center hidden">
        <div class="modal-content w-11/12 md:w-1/3 max-w-lg p-8 rounded-2xl shadow-2xl text-gray-800 flex flex-col items-center text-center">
            <p class="text-2xl font-bold mb-6" id="reset-modal-text"></p>
            <div class="flex gap-4">
                <button id="confirm-reset-btn" class="btn bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full">‡πÉ‡∏ä‡πà, ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button id="cancel-reset-btn" class="btn bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-full">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
        </div>
    </div>

    <script>
        const teams = ["‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 1", "‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 2", "‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 3", "‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà 4"];

        // --- GAME DATA 1, 2, 3 (Same as before) ---
        const gameData1 = { categories: ["‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", "‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", "‡πÇ‡∏£‡πÄ‡∏°‡∏≠‡∏£‡πå", "‡πÄ‡∏Ñ‡∏•‡∏ß‡∏¥‡∏ô"], questions: [[{ question: "‡πÅ‡∏õ‡∏•‡∏á 25¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "77¬∞F", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 50¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏Ñ‡∏•‡∏ß‡∏¥‡∏ô", answer: "323.15 K", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 80¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡πÇ‡∏£‡πÄ‡∏°‡∏≠‡∏£‡πå", answer: "64¬∞R√©", points: 300 }, { question: "‡πÅ‡∏õ‡∏•‡∏á -40¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "-40¬∞F", points: 400 }], [{ question: "‡πÅ‡∏õ‡∏•‡∏á 59¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "15¬∞C", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 95¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÇ‡∏£‡πÄ‡∏°‡∏≠‡∏£‡πå", answer: "28¬∞R√©", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 41¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏Ñ‡∏•‡∏ß‡∏¥‡∏ô", answer: "278.15 K", points: 300 }, { question: "‡πÅ‡∏õ‡∏•‡∏á -4¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "-20¬∞C", points: 400 }], [{ question: "‡πÅ‡∏õ‡∏•‡∏á 20¬∞R√© ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "25¬∞C", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 40¬∞R√© ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "122¬∞F", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 80¬∞R√© (‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏∑‡∏≠‡∏î) ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏Ñ‡∏•‡∏ß‡∏¥‡∏ô", answer: "373.15 K", points: 300 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 0¬∞R√© (‡∏à‡∏∏‡∏î‡πÄ‡∏¢‡∏∑‡∏≠‡∏Å‡πÅ‡∏Ç‡πá‡∏á) ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "32¬∞F", points: 400 }], [{ question: "‡πÅ‡∏õ‡∏•‡∏á 300 K ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "26.85¬∞C", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 273.15 K ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "32¬∞F", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 310 K (‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢) ‡πÄ‡∏õ‡πá‡∏ô ‡πÇ‡∏£‡πÄ‡∏°‡∏≠‡∏£‡πå", answer: "29.6¬∞R√©", points: 300 }, { question: "‡πÅ‡∏õ‡∏•‡∏á 0 K (‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏±‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå) ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "-273.15¬∞C", points: 400 }]] };
        const gameData2 = { categories: ["Q=mcŒîT", "Q=mL (‡∏´‡∏•‡∏≠‡∏°‡πÄ‡∏´‡∏•‡∏ß)", "Q=mL (‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠)"], questions: [[{ question: "‡∏ô‡πâ‡∏≥ 2 kg ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÄ‡∏û‡∏¥‡πà‡∏° 10¬∞C ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (c ‡∏ô‡πâ‡∏≥ = 4200 J/kg¬∞C)", answer: "Q = 84,000 J", points: 100 }, { question: "‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô 16,800 J ‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥ 1 kg ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?", answer: "ŒîT = 4¬∞C", points: 200 }, { question: "‡∏ô‡πâ‡∏≥ 500 ‡∏Å‡∏£‡∏±‡∏° 20¬∞C ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô 100¬∞C ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (c ‡∏ô‡πâ‡∏≥ = 4200 J/kg¬∞C)", answer: "Q = 168,000 J", points: 300 }, { question: "‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á 1 kg -10¬∞C ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0¬∞C ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (c ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á = 2100 J/kg¬∞C)", answer: "Q = 21,000 J", points: 400 }], [{ question: "‡∏´‡∏•‡∏≠‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á 0.5 kg ‡∏ó‡∏µ‡πà 0¬∞C ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (L = 334,000 J/kg)", answer: "Q = 167,000 J", points: 100 }, { question: "‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á 2 kg ‡∏´‡∏•‡∏≠‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà 0¬∞C ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?", answer: "Q = 668,000 J", points: 200 }, { question: "‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô 334,000 J ‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á‡∏ó‡∏µ‡πà 0¬∞C ‡∏à‡∏∞‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà kg?", answer: "1 kg", points: 300 }, { question: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏´‡∏•‡∏≠‡∏°‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á 1 kg ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥ 1 kg ‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤?", answer: "‚âà 79.5¬∞C", points: 400 }], [{ question: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥ 1 kg ‡∏ó‡∏µ‡πà 100¬∞C ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (L = 2,260,000 J/kg)", answer: "Q = 2,260,000 J", points: 100 }, { question: "‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥ 0.2 kg ‡∏ó‡∏µ‡πà 100¬∞C ‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡∏´‡∏°‡∏î ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?", answer: "Q = 452,000 J", points: 200 }, { question: "‡πÑ‡∏≠‡∏ô‡πâ‡∏≥ 0.1 kg ‡∏ó‡∏µ‡πà 100¬∞C ‡∏Ñ‡∏ß‡∏ö‡πÅ‡∏ô‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏î ‡∏à‡∏∞‡∏Ñ‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î?", answer: "Q = 226,000 J", points: 300 }, { question: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥ 1 kg ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≥ 100 kg ‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤?", answer: "‚âà 5.38¬∞C", points: 400 }]] };
        const gameData3 = { categories: ["4 ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ (‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥)", "4 ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ (‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á)", "5 ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ (‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≥)", "5 ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ (‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á)"], questions: [[{ question: "‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏î‡∏≥, ‡πÅ‡∏î‡∏á, ‡∏ó‡∏≠‡∏á", answer: "1kŒ© ¬±5%", points: 100 }, { question: "‡πÅ‡∏î‡∏á, ‡πÅ‡∏î‡∏á, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏ó‡∏≠‡∏á", answer: "220Œ© ¬±5%", points: 200 }, { question: "‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏°‡πà‡∏ß‡∏á, ‡∏î‡∏≥, ‡πÄ‡∏á‡∏¥‡∏ô", answer: "47Œ© ¬±10%", points: 300 }, { question: "‡∏™‡πâ‡∏°, ‡∏™‡πâ‡∏°, ‡πÅ‡∏î‡∏á, ‡∏ó‡∏≠‡∏á", answer: "3.3kŒ© ¬±5%", points: 400 }], [{ question: "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡πÄ‡∏ó‡∏≤, ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏ó‡∏≠‡∏á", answer: "680kŒ© ¬±5%", points: 100 }, { question: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡∏™‡πâ‡∏°, ‡πÄ‡∏á‡∏¥‡∏ô", answer: "56kŒ© ¬±10%", points: 200 }, { question: "‡∏Ç‡∏≤‡∏ß, ‡∏°‡πà‡∏ß‡∏á, ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏ó‡∏≠‡∏á", answer: "9.7MŒ© ¬±5%", points: 300 }, { question: "‡πÄ‡∏ó‡∏≤, ‡πÅ‡∏î‡∏á, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡πÄ‡∏á‡∏¥‡∏ô", answer: "8.2MŒ© ¬±10%", points: 400 }], [{ question: "‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏î‡∏≥, ‡∏î‡∏≥, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•", answer: "1kŒ© ¬±1%", points: 100 }, { question: "‡πÅ‡∏î‡∏á, ‡∏°‡πà‡∏ß‡∏á, ‡∏î‡∏≥, ‡∏î‡∏≥, ‡πÅ‡∏î‡∏á", answer: "270Œ© ¬±2%", points: 200 }, { question: "‡∏™‡πâ‡∏°, ‡∏Ç‡∏≤‡∏ß, ‡∏î‡∏≥, ‡∏ó‡∏≠‡∏á, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß", answer: "39Œ© ¬±0.5%", points: 300 }, { question: "‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡πÅ‡∏î‡∏á, ‡∏°‡πà‡∏ß‡∏á", answer: "41.5kŒ© ¬±0.1%", points: 400 }], [{ question: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡∏î‡∏≥, ‡∏™‡πâ‡∏°, ‡πÅ‡∏î‡∏á, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•", answer: "503kŒ© ¬±1%", points: 100 }, { question: "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏™‡πâ‡∏°, ‡πÅ‡∏î‡∏á", answer: "654kŒ© ¬±2%", points: 200 }, { question: "‡∏°‡πà‡∏ß‡∏á, ‡πÅ‡∏î‡∏á, ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡∏™‡πâ‡∏°, ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô", answer: "7.26MŒ© ¬±0.25%", points: 300 }, { question: "‡∏Ç‡∏≤‡∏ß, ‡∏î‡∏≥, ‡∏î‡∏≥, ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß", answer: "9MŒ© ¬±0.5%", points: 400 }]] };
        
        let gameData4; // Will be generated on initialization

        // --- GAME DATA 4: Mixed Questions Function ---
        function createMixedQuestionsGameData() {
            const heatElectricQuestions = [ { question: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏≥‡∏ô‡πâ‡∏≥‡∏£‡πâ‡∏≠‡∏ô 1000W ‡πÉ‡∏ä‡πâ‡∏ï‡πâ‡∏°‡∏ô‡πâ‡πâ‡∏≥ 1kg ‡∏ô‡∏≤‡∏ô 42 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏à‡∏∞‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤? (c=4200)", answer: "10 ¬∞C", points: 200 }, { question: "‡∏Å‡∏≤‡∏ï‡πâ‡∏°‡∏ô‡πâ‡∏≥ 2100W ‡πÉ‡∏ä‡πâ‡∏ï‡πâ‡∏°‡∏ô‡πâ‡πâ‡∏≥ 1kg ‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô 30¬∞C ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ? (c=4200)", answer: "60 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ", points: 300 }, { question: "‡πÄ‡∏ï‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ 700W ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥ 2kg ‡∏ô‡∏≤‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏à‡∏∞‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤? (c=4200)", answer: "5 ¬∞C", points: 400 }, { question: "‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏ô‡πâ‡∏≥ 0.5kg ‡∏ô‡∏≤‡∏ô 21 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏à‡∏ô‡∏£‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô 20¬∞C ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÉ‡∏î? (c=4200)", answer: "2000 W", points: 300 }, { question: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏≥‡∏ô‡πâ‡∏≥‡∏≠‡∏∏‡πà‡∏ô 2100W ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥ 5kg ‡∏ô‡∏≤‡∏ô 100 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏à‡∏∞‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏µ‡πà‡∏≠‡∏á‡∏®‡∏≤? (c=4200)", answer: "10 ¬∞C", points: 400 }, ];
            const tempConvertQuestions = [ { question: "‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 10¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡∏ü‡∏≤‡πÄ‡∏£‡∏ô‡πÑ‡∏Æ‡∏ï‡πå", answer: "50 ¬∞F", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 77¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "25 ¬∞C", points: 100 }, { question: "‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 50¬∞C ‡πÄ‡∏õ‡πá‡∏ô ‡πÇ‡∏£‡πÄ‡∏°‡∏≠‡∏£‡πå", answer: "40 ¬∞R√©", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ 32¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏Ñ‡∏•‡∏ß‡∏¥‡∏ô (‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì)", answer: "273 K", points: 200 }, { question: "‡πÅ‡∏õ‡∏•‡∏á‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ -40¬∞F ‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏ã‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏™", answer: "-40 ¬∞C", points: 300 }, ];
            const resistorQuestions = [ { question: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô: ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏î‡∏≥, ‡∏™‡πâ‡∏°, ‡∏ó‡∏≠‡∏á", answer: "10kŒ© ¬±5%", points: 100 }, { question: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô: ‡πÅ‡∏î‡∏á, ‡∏°‡πà‡∏ß‡∏á, ‡πÅ‡∏î‡∏á, ‡∏ó‡∏≠‡∏á", answer: "2.7kŒ© ¬±5%", points: 200 }, { question: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô: ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡∏°‡πà‡∏ß‡∏á, ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•, ‡∏ó‡∏≠‡∏á", answer: "470Œ© ¬±5%", points: 200 }, { question: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô: ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß, ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô, ‡∏î‡∏≥, ‡∏ó‡∏≠‡∏á", answer: "56Œ© ¬±5%", points: 300 }, { question: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô: ‡∏™‡πâ‡∏°, ‡∏Ç‡∏≤‡∏ß, ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á, ‡πÄ‡∏á‡∏¥‡∏ô", answer: "390kŒ© ¬±10%", points: 400 }, ];
            let allQuestions = [...heatElectricQuestions, ...heatElectricQuestions, ...tempConvertQuestions, ...resistorQuestions].sort(() => 0.5 - Math.random());
            let structuredQuestions = [];
            for (let i = 0; i < 5; i++) { structuredQuestions.push(allQuestions.slice(i * 4, (i + 1) * 4)); }
            return { categories: ["‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1", "‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2", "‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3", "‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 4", "‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 5"], questions: structuredQuestions };
        }

        // --- REWARDS for Page 4 ---
        const rewards = [
            { type: 'text', template: "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© {n} ‡πÉ‡∏ö", range: [1, 5] },
            { type: 'text', template: "‡∏à‡∏≠‡∏°‡πÇ‡∏à‡∏£! ‡∏Ç‡πÇ‡∏°‡∏¢‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡∏°‡∏•‡∏∞ {n} ‡πÉ‡∏ö", range: [1, 5] },
            { type: 'points', template: "‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡πÅ‡∏ï‡∏Å! ‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© {n} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô", range: [100000, 5000000] },
            { type: 'text', template: "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô! ‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì {n} ‡πÉ‡∏ö", range: [1, 5] },
            { type: 'text', template: "‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß! ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡∏°‡∏≠‡∏∑‡πà‡∏ô {n} ‡∏Ñ‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡∏°‡∏Ñ‡∏∏‡∏ì", range: [1, 2] }
        ];

        let scores = [];
        let askedQuestions1 = [], askedQuestions2 = [], askedQuestions3 = [], askedQuestions4 = [];
        let gameInitialized = { 1: false, 2: false, 3: false, 4: false };
        let resetAction = null;

        const gameContainers = { 1: document.getElementById('game-container-1'), 2: document.getElementById('game-container-2'), 3: document.getElementById('game-container-3'), 4: document.getElementById('game-container-4') };
        const pageBtns = { 1: document.getElementById('page1-btn'), 2: document.getElementById('page2-btn'), 3: document.getElementById('page3-btn'), 4: document.getElementById('page4-btn') };
        
        const questionModal = document.getElementById('question-modal');
        const rewardModal = document.getElementById('reward-modal');
        const resetModal = document.getElementById('reset-modal');
        const confirmResetBtn = document.getElementById('confirm-reset-btn');
        const cancelResetBtn = document.getElementById('cancel-reset-btn');

        function resetAll() {
            scores = new Array(teams.length).fill(0);
            Object.keys(gameInitialized).forEach(pageNum => initializeBoard(pageNum));
            updateAllScoreboards();
        }

        function initializeBoard(gameNum) {
            gameNum = Number(gameNum);
            if (gameNum === 1) { askedQuestions1 = gameData1.questions.map(cat => cat.map(() => false)); renderGameBoard(gameData1, askedQuestions1, 'game-board-1', 1); } 
            else if (gameNum === 2) { askedQuestions2 = gameData2.questions.map(cat => cat.map(() => false)); renderGameBoard(gameData2, askedQuestions2, 'game-board-2', 2); } 
            else if (gameNum === 3) { askedQuestions3 = gameData3.questions.map(cat => cat.map(() => false)); renderGameBoard(gameData3, askedQuestions3, 'game-board-3', 3); } 
            else if (gameNum === 4) { 
                gameData4 = createMixedQuestionsGameData(); // Re-shuffle questions
                askedQuestions4 = gameData4.questions.map(cat => cat.map(() => false)); 
                renderGameBoard(gameData4, askedQuestions4, 'game-board-4', 4); 
            }
            renderScoreboard(teams, scores, `scoreboard-${gameNum}`);
            gameInitialized[gameNum] = true;
        }

        function updateAllScoreboards() {
            Object.keys(gameInitialized).forEach(pageNum => {
                 if(gameInitialized[pageNum]) { renderScoreboard(teams, scores, `scoreboard-${pageNum}`); }
            });
        }

        function renderScoreboard(teams, scores, elementId) {
            const scoreboard = document.getElementById(elementId);
            if(!scoreboard) return;
            scoreboard.innerHTML = '';
            teams.forEach((team, index) => {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-score-card p-4 rounded-lg text-center';
                teamCard.innerHTML = `<h2 class="text-xl font-bold">${team}</h2><p class="text-3xl font-bold">${scores[index].toLocaleString('th-TH')}</p>`;
                scoreboard.appendChild(teamCard);
            });
        }

        function renderGameBoard(gameData, askedState, elementId, gameNum) {
            const gameBoard = document.getElementById(elementId);
            gameBoard.innerHTML = '';
            gameData.categories.forEach(category => {
                const categoryHeader = document.createElement('div');
                categoryHeader.className = 'text-2xl font-bold text-center py-4';
                categoryHeader.textContent = category;
                gameBoard.appendChild(categoryHeader);
            });
            const numQuestions = gameData.questions[0].length;
            for (let i = 0; i < numQuestions; i++) {
                for (let j = 0; j < gameData.categories.length; j++) {
                    const questionData = gameData.questions[j][i];
                    const card = document.createElement('div');
                    card.className = 'card text-3xl font-bold h-24 flex items-center justify-center cursor-pointer';
                    if (askedState[j][i]) card.classList.add('asked');
                    card.textContent = questionData.points;
                    card.dataset.categoryIndex = j;
                    card.dataset.questionIndex = i;
                    card.addEventListener('click', (event) => handleCardClick(event, gameNum));
                    gameBoard.appendChild(card);
                }
            }
        }

        function handleCardClick(event, gameNum) {
            const card = event.currentTarget;
            if (card.classList.contains('asked')) return;

            const catIndex = card.dataset.categoryIndex;
            const qIndex = card.dataset.questionIndex;

            let gameData, askedQuestions;
            if (gameNum === 1) { [gameData, askedQuestions] = [gameData1, askedQuestions1]; }
            else if (gameNum === 2) { [gameData, askedQuestions] = [gameData2, askedQuestions2]; }
            else if (gameNum === 3) { [gameData, askedQuestions] = [gameData3, askedQuestions3]; }
            else { [gameData, askedQuestions] = [gameData4, askedQuestions4]; }

            askedQuestions[catIndex][qIndex] = true;
            card.classList.add('asked');
            
            const questionData = gameData.questions[catIndex][qIndex];
            showQuestionModal(questionData, gameData.categories[catIndex], gameNum);
        }

        function showQuestionModal(questionData, category, gameNum) {
            document.getElementById('modal-category').textContent = category;
            document.getElementById('modal-points').textContent = `${questionData.points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`;
            document.getElementById('modal-question').textContent = questionData.question;
            document.getElementById('modal-answer').textContent = questionData.answer;

            const awardButtonsContainer = document.getElementById('award-buttons');
            awardButtonsContainer.innerHTML = '';
            teams.forEach((team, index) => {
                const button = document.createElement('button');
                button.className = 'btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full';
                button.textContent = `‡πÉ‡∏´‡πâ ${team}`;
                if (gameNum === 4) {
                    button.onclick = () => awardPointsAndShowReward(index, questionData.points);
                } else {
                    button.onclick = () => awardPoints(index, questionData.points);
                }
                awardButtonsContainer.appendChild(button);
            });
            const noScoreButton = document.createElement('button');
            noScoreButton.className = 'btn bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-full';
            noScoreButton.textContent = '‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô';
            noScoreButton.onclick = () => { questionModal.classList.add('hidden'); };
            awardButtonsContainer.appendChild(noScoreButton);

            document.getElementById('modal-answer-container').classList.add('hidden');
            document.getElementById('reveal-answer-btn').classList.remove('hidden');
            questionModal.classList.remove('hidden');
        }

        function awardPoints(teamIndex, points) {
            scores[teamIndex] += points;
            updateAllScoreboards();
            questionModal.classList.add('hidden');
        }

        function awardPointsAndShowReward(teamIndex, points) {
            scores[teamIndex] += points;
            updateAllScoreboards();
            questionModal.classList.add('hidden');
            showRewardModal();
        }
        
        function randomInRange(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function showRewardModal() {
            let chosenReward;
            const randomNumber = Math.random() * 100; // ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 0-99.99

            // 5% chance for team swap
            if (randomNumber < 5) { 
                chosenReward = rewards.find(r => r.template.includes("‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß"));
            } else { 
            // 95% chance for other rewards
                const otherRewards = rewards.filter(r => !r.template.includes("‡∏î‡∏∂‡∏á‡∏ï‡∏±‡∏ß"));
                chosenReward = otherRewards[Math.floor(Math.random() * otherRewards.length)];
            }
            
            const n = randomInRange(chosenReward.range[0], chosenReward.range[1]);
            const rewardText = chosenReward.template.replace('{n}', n.toLocaleString('th-TH'));

            document.getElementById('reward-text').textContent = rewardText;

            const rewardButtonsContainer = document.getElementById('reward-buttons');
            rewardButtonsContainer.innerHTML = '';
            teams.forEach((team, index) => {
                const button = document.createElement('button');
                button.className = 'btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full';
                button.textContent = `‡πÉ‡∏´‡πâ ${team}`;
                button.onclick = () => assignReward(index, chosenReward, n);
                rewardButtonsContainer.appendChild(button);
            });
            
            rewardModal.classList.remove('hidden');
        }

        function assignReward(teamIndex, rewardInfo, value) {
            if (rewardInfo.type === 'points') {
                scores[teamIndex] += value;
                updateAllScoreboards();
            }
            rewardModal.classList.add('hidden');
        }

        document.getElementById('reveal-answer-btn').addEventListener('click', () => {
            document.getElementById('modal-answer-container').classList.remove('hidden');
            document.getElementById('reveal-answer-btn').classList.add('hidden');
        });

        document.getElementById('close-modal-btn').addEventListener('click', () => questionModal.classList.add('hidden'));
        document.getElementById('close-reward-modal-btn').addEventListener('click', () => rewardModal.classList.add('hidden'));

        document.querySelectorAll('.reset-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                resetAction = e.currentTarget.dataset.resetType;
                const modalText = document.getElementById('reset-modal-text');
                if (resetAction === 'full') {
                    modalText.textContent = '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?';
                } else {
                    modalText.textContent = `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)`;
                }
                resetModal.classList.remove('hidden');
            });
        });

        confirmResetBtn.addEventListener('click', () => {
            if (resetAction === 'full') {
                resetAll();
            } else if (resetAction.startsWith('page')) {
                initializeBoard(resetAction.replace('page', ''));
            }
            resetModal.classList.add('hidden');
        });

        cancelResetBtn.addEventListener('click', () => resetModal.classList.add('hidden'));
        
        function switchPage(pageNum) {
            Object.values(gameContainers).forEach(c => c.classList.add('hidden'));
            gameContainers[pageNum].classList.remove('hidden');

            Object.values(pageBtns).forEach(b => b.classList.remove('nav-btn-active', 'bg-blue-600', 'bg-purple-600', 'bg-green-600', 'bg-orange-600'));
            Object.values(pageBtns).forEach(b => b.classList.add('bg-gray-500'));
            
            let activeColor;
            if (pageNum == 1) activeColor = 'bg-blue-600';
            else if (pageNum == 2) activeColor = 'bg-purple-600';
            else if (pageNum == 3) activeColor = 'bg-green-600';
            else if (pageNum == 4) activeColor = 'bg-orange-600';

            pageBtns[pageNum].classList.add('nav-btn-active', activeColor);
            pageBtns[pageNum].classList.remove('bg-gray-500');

            if (!gameInitialized[pageNum]) {
                initializeBoard(pageNum);
            }
        }
        
        Object.keys(pageBtns).forEach(pageNum => {
            pageBtns[pageNum].addEventListener('click', () => switchPage(pageNum));
        });

        // Initial load
        resetAll();
        switchPage(1);

    </script>
</body>
</html>


